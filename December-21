import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
from sklearn.preprocessing import StandardScaler, MinMaxScaler, OneHotEncoder, LabelEncoder
from sklearn.model_selection import train_test_split
from sklearn.linear_model import LogisticRegression
from sklearn.naive_bayes import GaussianNB, MultinomialNB, BernoulliNB
from sklearn.neighbors import KNeighborsClassifier
from sklearn.svm import SVC
from sklearn.tree import DecisionTreeClassifier
from sklearn.ensemble import RandomForestClassifier
from sklearn.metrics import (accuracy_score, confusion_matrix, classification_report,roc_auc_score, roc_curve, auc)
import warnings
warnings.filterwarnings('ignore')


data = pd.read_csv('https://archive.ics.uci.edu/ml/machine-learning-databases/breast-cancer-wisconsin/breast-cancer-wisconsin.data', header=None)
data.columns = ['Sample code', 'Clump Thickness', 'Uniformity of Cell Size', 'Uniformity of Cell Shape', 'Marginal Adhesion',
'Single Epithelial Cell Size', 'Bare Nuclei', 'Bland Chromatin', 'Normal Nucleoli', 'Mitoses', 'Class']

print(data.head())
print(data.info())
print(data.describe())
print(data.isnull().sum())
print(data['Bare Nuclei'].value_counts())
print(data['Class'].value_counts())
print(data.sample(2))

sns.boxplot(x=data["Normal Nucleoli"])
plt.title("Normal Nucleoli (Outliers & Spread)")
#plt.show()

data.drop(columns="Sample code", axis = 1, inplace = True)
x_train, x_test, y_train, y_test = train_test_split(data.drop(columns="Class"), data["Class"], test_size=0.2, random_state=42)

# scaler = MinMaxScaler()
# x_train = scaler.fit_transform(x_train)
# x_test = scaler.transform(x_test)
# print(x_train.shape, x_test.shape, y_train.shape, y_test.shape)


rf= RandomForestClassifier()
rf.fit(x_train, y_train)
y_pred = rf.predict(x_test)
accuracy_score = accuracy_score(y_test, y_pred)
print("Accuracy Score:", accuracy_score*100)